---
phase: 40-acceptance-tests-v18
plan: 01
status: COMPLETED
estimated_duration: ~10min
---

## Goal

Create an acceptance test script covering all 10 new v1.8 built-in functions with correct expected output.

## Requirements Traced

- TEST-01: Acceptance test script covering all 10 new v1.8 functions
- TEST-02: All existing acceptance tests still pass

## Analysis

### Test pattern

Follow the existing `acceptance-wins.sh` pattern:
- Binary discovery (dist/qseries.exe fallback chain)
- `run()` helper to pipe input lines
- Each test: pipe input, grep for expected output, report PASS/FAIL
- Summary line at end, exit 1 if any fail

### Functions to test (10 total)

**Number Theory (6):**
1. `divisors(12)` → expect `[1, 2, 3, 4, 6, 12]`
2. `mobius(30)` → expect `-1`
3. `mobius(12)` → expect `0`
4. `euler_phi(12)` → expect `4`
5. `jacobi(2, 15)` → expect `1`
6. `kronecker(-1, -1)` → expect `-1`

**Convenience (2):**
7. `coeff(etaq(1,30), 5)` → expect `1`
8. `dissect(etaq(1,30), 3, 10)` → expect `k=0:` in output

**Math Enrichment (3):**
9. `eisenstein(2, 10)` → expect `240q` in output
10. `partition(100)` → expect `190569292`
11. `qdiff(1 + q + q^2 + q^3)` → expect `2q` in output (qdiff outputs q + 2q² + 3q³)

### Makefile integration

Add a `acceptance-v18` target to the Makefile.

## Tasks

### Task 1: Create tests/acceptance-v18.sh

**File:** `tests/acceptance-v18.sh`

Script with the same structure as `acceptance-wins.sh`:
- Binary discovery
- `run()` helper
- 11 test cases covering all 10 functions (mobius tested twice for both return values)
- Summary + exit code

### Task 2: Add Makefile target

**File:** `Makefile`

Add `acceptance-v18` target that runs the new script.

### Task 3: Run all tests

- Run `tests/acceptance-v18.sh` — all must pass
- Run `tests/acceptance.sh` — all 10 must pass
- Run `tests/acceptance-wins.sh` — all 7 must pass

## Verification Criteria

- [ ] `tests/acceptance-v18.sh` exists and is executable
- [ ] All 11 test cases pass
- [ ] All existing acceptance tests still pass
- [ ] Makefile has `acceptance-v18` target
