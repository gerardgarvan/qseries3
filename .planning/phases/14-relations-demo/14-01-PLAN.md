---
phase: 14-relations-demo
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [demo/garvan-demo.sh]
autonomous: true

must_haves:
  truths:
    - "findhom yields Gauss AGM relations (X₁²+X₂²-2X₃², -X₁X₂+X₄²) when demo runs"
    - "findhomcombo example runs and produces expected polynomial (U_{5,6} or theta fallback)"
    - "findnonhomcombo Watson example runs and produces expected polynomial"
  artifacts:
    - path: demo/garvan-demo.sh
      provides: "Relations section with three run blocks"
      contains: "findhom", "findhomcombo", "findnonhomcombo"
  key_links:
    - from: demo/garvan-demo.sh
      to: "qseries binary"
      via: run function
      pattern: "run \"set_trunc"
---

<objective>
Replace the Relations placeholder in garvan-demo.sh with three run blocks from 14-RESEARCH.md: findhom (Gauss AGM), findhomcombo (Eisenstein U_{5,6}), findnonhomcombo (Watson).

Purpose: DEMO-04 — relation-finding examples reproduce qseriesdoc §4.

Output: demo/garvan-demo.sh Relations section with correct commands; `cd dist && bash demo/garvan-demo.sh` produces expected outputs for all three blocks.
</objective>

<execution_context>
@C:/Users/ggarv/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ggarv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-relations-demo/14-RESEARCH.md
@demo/garvan-demo.sh
</context>

<tasks>

<task type="auto">
  <name>Replace Relations placeholder with three run blocks</name>
  <files>demo/garvan-demo.sh</files>
  <action>
Replace the Relations section (# === Relations: findhom, findhomcombo, findnonhomcombo ... ===) with exactly three run blocks from 14-RESEARCH.md:

1. **findhom (Gauss AGM)** — §4.1:
   echo "" and echo "--- findhom: Gauss AGM (qseriesdoc §4.1) ---"
   run "set_trunc(100)" "findhom([theta3(q,100), theta4(q,100), theta3(subs_q(q,2),100), theta4(subs_q(q,2),100)], 2, 0)"

2. **findhomcombo (Eisenstein U_{5,6})** — §4.2:
   echo "" and echo "--- findhomcombo: U_{5,6} (qseriesdoc §4.2) ---"
   run "set_trunc(50)" "f := sum(sum(legendre(m,5)*n^5*q^(m*n), n, 1, 50), m, 1, 50)" "B1 := etaq(1,50)^5/etaq(5,50)" "B2 := q*etaq(5,50)^5/etaq(1,50)" "findhomcombo(f, [B1, B2], 3, 0)"
   Expected output: X₁²·X₂ + 40·X₁·X₂² + 335·X₂³ (coefficients 1, 40, 335)

   **Fallback (if nested sum fails):** If sum(sum(...), n, 1, 50), m, 1, 50) causes parse or eval error, replace with theta-based example:
   run "set_trunc(100)" "findhomcombo(theta3(subs_q(q,2),100)^2, [theta3(q,100), theta4(q,100)], 2, 0)"
   Expected: (1/2)X₁²+(1/2)X₂². Add comment in script: "# Fallback: nested sum unsupported; using theta-based findhomcombo"

3. **findnonhomcombo (Watson)** — §4.4:
   echo "" and echo "--- findnonhomcombo: Watson modular equation (qseriesdoc §4.4) ---"
   run "set_trunc(100)" "xi := q^2*etaq(49,100)/etaq(1,100)" "T := q*(etaq(7,100)/etaq(1,100))^4" "findnonhomcombo(T^2, [T, xi], [1, 7], 0)"
   Expected: Watson coefficients (343, 49) in polynomial form

Preserve the exact `run "cmd1" "cmd2" ...` pattern used in Product conversion section. Section header: # === Relations: findhom, findhomcombo, findnonhomcombo (qseriesdoc §4) ===
  </action>
  <verify>
cd dist && bash demo/garvan-demo.sh 2>&1 | grep -E "findhom:|findhomcombo:|findnonhomcombo:"
cd dist && bash demo/garvan-demo.sh 2>&1 | grep -E "X|343|49|335|40" | head -20
  </verify>
  <done>
Relations section has three run blocks; findhom yields Gauss AGM relations (X₁²+X₂²-2X₃², -X₁X₂+X₄²); findhomcombo runs (U_{5,6} or theta fallback) and produces polynomial; findnonhomcombo yields Watson modular equation with coefficients 343, 49.
  </done>
</task>

</tasks>

<verification>
- Run `cd dist && bash demo/garvan-demo.sh` — Relations section output visible
- findhom output contains X₁²+X₂²-2X₃² and -X₁X₂+X₄² (or equivalent formatting)
- findhomcombo output contains polynomial (U_{5,6}: 1, 40, 335; theta fallback: 1/2, 1/2)
- findnonhomcombo output contains Watson coefficients (343, 49) and polynomial form
</verification>

<success_criteria>
1. findhom yields Gauss AGM relations (X₁²+X₂²-2X₃², -X₁X₂+X₄²) in demo
2. findhomcombo example runs and produces expected polynomial
3. findnonhomcombo example runs and produces expected output
</success_criteria>

<output>
After completion, create `.planning/phases/14-relations-demo/14-01-SUMMARY.md`
</output>
