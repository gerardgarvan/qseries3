---
phase: 16-script-mode
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/repl.h
autonomous: true

must_haves:
  truths:
    - "qseries < script.qs runs non-interactively: commands sequential, exit on EOF"
    - "Script mode = stdin not TTY: no interactive prompt; banner suppressed"
    - "TTY mode unchanged: banner and prompt shown when stdin is TTY"
  artifacts:
    - path: src/repl.h
      provides: runRepl with TTY-aware banner
      contains: "stdin_is_tty", "runRepl"
  key_links:
    - from: src/repl.h
      to: stdio/TTY detection
      via: "stdin_is_tty(), isatty"
      pattern: "stdin_is_tty"
---

<objective>
Wrap the banner in if(stdin_is_tty()) in repl.h runRepl() so that when stdin is not a TTY (e.g. qseries < script.qs), the ASCII art and version line are suppressed. Command echo and prompt logic remain as-is.

Purpose: QOL-01 — Script mode with no banner clutter; interactive mode unchanged
Output: src/repl.h with banner guarded by stdin_is_tty()
</objective>

<execution_context>
@C:/Users/ggarv/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ggarv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-script-mode/16-CONTEXT.md
@.planning/phases/16-script-mode/16-RESEARCH.md
@src/repl.h
</context>

<tasks>

<task type="auto">
  <name>Guard banner with stdin_is_tty() in runRepl()</name>
  <files>src/repl.h</files>
  <action>
In runRepl(), wrap the banner output (the entire std::cout &lt;&lt; R"banner(...)banner" &lt;&lt; std::endl block) in:

  if (stdin_is_tty())
      std::cout &lt;&lt; R"banner(...)banner" &lt;&lt; std::endl;

stdin_is_tty() is already defined in repl.h (lines 19–24). No other changes: keep command echo (qseries&gt; &lt;line&gt; when not TTY), prompt (qseries&gt; before getline when TTY), continue-on-error.
  </action>
  <verify>
Interactive: run qseries, type "q" — banner appears before first prompt.
Script: echo "q" | qseries — no banner; output is only qseries&gt; q and the series result.
  </verify>
  <done>Banner shown only when stdin_is_tty(); script mode outputs no banner.</done>
</task>

</tasks>

<verification>
- Build succeeds
- `qseries` (interactive): banner visible
- `echo "q" | qseries`: no banner; only command echo + result
- `qseries < script.qs`: no banner; commands run sequentially; exit on EOF
</verification>

<success_criteria>
1. qseries &lt; script.qs runs without banner
2. Interactive qseries shows banner
3. Commands sequential, exit on EOF (unchanged)
</success_criteria>

<output>
After completion, create `.planning/phases/16-script-mode/16-01-SUMMARY.md`
</output>
