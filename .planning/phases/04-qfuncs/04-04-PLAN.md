---
phase: 04-qfuncs
plan: 04
type: execute
wave: 4
depends_on: [04-03]
files_modified: [src/main.cpp]
autonomous: true

must_haves:
  truths:
    - "etaq(q,1,T) Euler pentagonal; 1/etaq(q,1,50) partition coeffs 1,1,2,3,5,7,11,15,22,30,42"
    - "aqprod, qbin, theta, tripleprod tests pass"
    - "Phase 4 tests must pass before Phase 5 (prodmake)"
  artifacts:
    - path: src/main.cpp
      provides: BigInt + Frac + Series + qfuncs test driver
      contains: "etaq"
  key_links:
    - from: "main.cpp"
      to: "qfuncs.h"
      via: "#include"
      pattern: "#include.*qfuncs"
---

<objective>
Extend main.cpp with qfuncs test suite. Per CONTEXT: TEST-02 partition function; Euler pentagonal; aqprod, qbin, theta, products.
</objective>

Purpose: Validate qfuncs. Must pass before Phase 5. Locked: broader suite, must pass before prodmake.
Output: main.cpp runs all tests; exits 0 when pass.

<execution_context>
@C:/Users/ggarv/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ggarv/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/04-qfuncs/04-CONTEXT.md
@.planning/phases/04-qfuncs/04-RESEARCH.md
@SPEC.md
@src/main.cpp
@src/qfuncs.h
</context>

<tasks>

<task type="auto">
  <name>Task 1: Euler pentagonal and TEST-02 partition</name>
  <files>src/main.cpp</files>
  <action>
Add #include "qfuncs.h". Add section "=== qfuncs Phase 4 test driver ===".

1. **Euler pentagonal:** etaq(q,1,20) coeffs at 0,1,2,5,7,12,15 are ±1; zero elsewhere in range
2. **TEST-02 Partition:** p = 1/etaq(q,1,50); CHECK p.coeff(0..10) == 1,1,2,3,5,7,11,15,22,30,42
</action>
  <verify>Pentagonal and partition coeffs match</verify>
  <done>Euler pentagonal + partition tests pass</done>
</task>

<task type="auto">
  <name>Task 2: aqprod, qbin, etaq</name>
  <files>src/main.cpp</files>
  <action>
Add tests:
- aqprod(q,q,5,20) = (1-q)(1-q²)...(1-q⁵); aqprod(q,q,0,T)=1
- qbin(q,0,n,T)=1; qbin(q,n,n,T)=1; qbin(q,1,3,T) coeffs
- etaq(q,2,T) spot-check
</action>
  <verify>aqprod, qbin, etaq tests pass</verify>
  <done>Core qfuncs tests pass</done>
</task>

<task type="auto">
  <name>Task 3: theta, tripleprod</name>
  <files>src/main.cpp</files>
  <action>
Add tests:
- theta2(q,T) coeff[0]==2, coeff[2]==2
- theta3(q,T) coeff[0]==1, coeff[1]==2, coeff[4]==2
- theta4(q,T) alternating signs at squares
- tripleprod spot-check
</action>
  <verify>theta and tripleprod tests pass</verify>
  <done>Phase 4 success criteria satisfied</done>
</task>

</tasks>

<verification>
- g++ compiles; ./qseries exits 0
- All BigInt, Frac, Series tests still pass
- Partition 1,1,2,3,5,7,11,15,22,30,42; pentagonal ±1
</verification>

<success_criteria>
- Phase 4 success: etaq pentagonal, partition TEST-02, aqprod, qbin, theta, products
- Ready for Phase 5 (prodmake)
</success_criteria>

<output>
After completion, create `.planning/phases/04-qfuncs/04-04-SUMMARY.md`
</output>
